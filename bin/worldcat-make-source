#!/usr/bin/python3

import sys

sys.path.append('')
import rengu.worldcat

import yaml
from rengu.tools import YamlDumper


for isbn in sys.stdin.readlines():

    source = rengu.worldcat.search_isbn(isbn)

    if source:
        title = source["Title"].strip().lower().replace("'","").replace(",","").replace(" ", "-")

        fout = open("tmp/sources/" + title, "w")

        fout.write(yaml.dump(dict(source),
                             Dumper=YamlDumper, default_flow_style=False,
                             width=70, indent=2,
                             explicit_start=True, explicit_end=True, allow_unicode=True, ))
        fout.close()

